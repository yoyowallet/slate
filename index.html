<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Yoyo Wallet API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell","swift","java"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="swift">swift</a>
              <a href="#" data-language-name="java">java</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introduction">Introduction</h1>

<p>Welcome to the Yoyo Wallet platform.</p>

<p>The platform opens up the functionality of Yoyo Wallet to application developers.</p>

<p>The main feaures of the platform are:</p>

<ul>
<li>Identity</li>
<li>Payment</li>
<li>Loyalty</li>
<li>Vouchers</li>
<li>Analytics</li>
</ul>

<h2 id="accessing-the-platform">Accessing the platform</h2>

<p>There are two different ways you can access the Yoyo Wallet platform.</p>

<ul>
<li>via an SDK</li>
<li>via the RESTful API</li>
</ul>

<p>Before doing anything with the Yoyo Wallet platform you&rsquo;ll need an account.</p>

<h2 id="getting-a-yoyo-wallet-account">Getting a Yoyo Wallet account</h2>

<p>If you&rsquo;re interested in developing an application on the Yoyo Wallet platform, please <a href="http://yoyowallet.com/contact-us/">contact us</a></p>

<p>Once you&rsquo;re registered with a Yoyo Wallet account you&rsquo;ll get the following information.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>account_id</td>
<td>This is your unique account identifer</td>
</tr>
<tr>
<td>access_key</td>
<td>This is your access key</td>
</tr>
<tr>
<td>secret_key</td>
<td>This is your secret key (keep it somewhere safe&hellip;)</td>
</tr>
</tbody></table>

<p>We&rsquo;ll also create an administrative user so you can login to our <a href="https://dashboard.test.yoyowallet.net">dashboard</a> and manage your account.</p>

<h2 id="sdks">SDKs</h2>

<p>We have developed iOS and Android SDKs that make it easy to interact with the most useful endpoints on our platform.  These SDKs are focused on making it easy to build an application on top of the Yoyo Wallet platform.</p>

<p>In fact we&rsquo;re using the SDK ourselves to build the next version of Yoyo Wallet as we speak.</p>

<h3 id="ios-sdk">iOS SDK</h3>

<p>The iOS SDK can be downloaded here: <a href="http:">http://</a></p>

<h3 id="android-sdk">Android SDK</h3>

<p>The Android SDK can be downloaded here: <a href="http:">http://</a></p>

<h2 id="restful-api-ui">RESTful API UI</h2>

<p>If you&rsquo;re a web developer you may prefer to code directly against our RESTful API.  To make life easier for you web devs, we&rsquo;ve also put a nice browser front end on the API for you to explore.</p>

<p>The sandbox version can be found here: <a href="http://api.test.yoyowallet.net/apidocs/">http://api.test.yoyowallet.net/apidocs/</a></p>

<p>The Yoyo developers like to eat their own dogfood, so the API is also used by our admin dashboards as well as the mobile SDKs.
Therefore there are quite a LOT of endpoints in here.</p>

<p>We&rsquo;ll be documenting the most important ones to get you on your way to developing the next killer application on top of the Yoyo Wallet platform.</p>

<h3 id="authentication-challenge">Authentication challenge</h3>

<p>When you use the RESTful UI for the first time you will see the authentication challenge dialog box.  This is because you are trying to make an authenticated request to the API.</p>

<p><img src="images/auth-challenge.png" alt="Authentication challenge" style="width: 400px;"/></p>

<ul>
<li>user name = <strong>$access_key</strong></li>
<li>password = <strong>$secret_key</strong></li>
</ul>

<p>From now on the browser will take care of adding the appropriate authentication header to your requests.</p>

<p>If you don&rsquo;t have an <strong>$access_key</strong> or <strong>$secret_key</strong> yet, see <a href="#getting-a-yoyo-wallet-account">getting a Yoyo Wallet account</a></p>

          <h1 id="platform-users">Platform Users</h1>

<p>The Yoyo Wallet platform is accessed by three different types of users.  </p>

<ul>
<li>Consumers with mobile devices</li>
<li>Dashboard users</li>
<li>Transaction devices</li>
</ul>

<h2 id="consumers">Consumers</h2>

<p>Consumers are the people using the Yoyo Wallet powered applications.  They are <em>your</em> customers.</p>

<p>Once a consumer has registered with the Yoyo Wallet platform they are able to reuse their Yoyo Wallet account on any application using the platform.  They won&rsquo;t have to register again, or add their credit card again.  It&rsquo;ll just be there ready and waiting for them when they login.</p>

<h2 id="dashboard-users">Dashboard users</h2>

<p>Dashboard users are you, and your employees.  These users have access to the dashboard to browse and/or administer information specific to your Yoyo Wallet platform account.</p>

<p>Dashboard users are authenticated via a traditional web login.</p>

<h2 id="transaction-devices">Transaction devices</h2>

<p>Retailers supporting Yoyo Wallet will need have a Yoyo compatible EPOS (electronic point of sale) device or a mobile device integrated with the Transaction API such as Yoyo Accept.</p>

          <h1 id="authentication">Authentication</h1>

<p>Every request to the API must be an authenticated request.  When you join the Yoyo Wallet platform you will be given an access_key and a secret_key.  These keys are used to authenticate your requests to the platform.</p>

<p>Requests to the platform API are authenticated using basic auth.</p>

<p>To authenticate a request, send an “AUTHORIZATION” header of form:</p>

<p>Basic base64({ACCESS_KEY}:{SECRET_KEY})</p>

<p><code class="prettyprint">Authorization: &lt;base64 encrypted {ACCESS_KEY}:{SECRET_KEY}&gt;</code></p>

<aside class="notice">
You must replace <code>{ACCESS_KEY}_{SECRET_KEY}</code> with your real API credentials.
</aside>

<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With shell, you can just pass the correct header with each request</span>

curl <span class="s1">'https://api.test.yoyowallet.net/v1/accounts/{ACCOUNT_ID}'</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span>
</code></pre>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">NSObject</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>

  <span class="kt">Yoyo</span><span class="o">.</span><span class="kt">APIKey</span> <span class="o">=</span> <span class="s">"YOUR_API_KEY"</span>
  <span class="kt">Yoyo</span><span class="o">.</span><span class="kt">APISecret</span> <span class="o">=</span> <span class="s">"YOUR_API_SECRET"</span>
  <span class="kt">Yoyo</span><span class="o">.</span><span class="n">accountID</span> <span class="o">=</span> <span class="s">"YOUR_ACCOUNT_ID"</span>

  <span class="k">return</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<blockquote>
<p>Make sure to replace <code class="prettyprint">{ACCESS_KEY}</code> and <code class="prettyprint">{SECRET_KEY}</code> with your real API credentials.</p>
</blockquote>

          <h1 id="consumer-api">Consumer API</h1>

<p>The Consumer API is a RESTful API which uses JSON formatted data for its requests and responses. It used by mobile device applications to communicate with the Yoyo Wallet platform.</p>

<h2 id="authentication">Authentication</h2>

<p>As a mobile app developer your app users will need to have a Yoyo Wallet consumer account.  </p>

<p>Consumer registration and authentication follow the same process.  This is a two factor authentication process to verify you are the owner of the mobile phone.</p>

<h3 id="1-request-a-passcode">1. Request a passcode</h3>

<p>First you must request a passcode.  The passcode is a unique 5 digit number that will be sent to your mobile device.</p>

<blockquote>
<p>You POST a request to the API containing the consumers phone number and email address.</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tommy.tester@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"441234567890"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight shell"><code>curl <span class="s1">'https://api.test.yoyowallet.net/v1/consumer-passcodes'</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span> <span class="se">\</span>
  -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
  --data-binary <span class="nv">$'</span><span class="o">{</span><span class="s2">"email"</span>: <span class="s2">"tommy.tester@example.com"</span>, <span class="s2">"phone"</span>: <span class="s2">"441234567890"</span><span class="o">}</span><span class="s1">'
</span></code></pre>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">Yoyo</span>

<span class="kd">class</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="kt">LoginViewControllerDelegate</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">login</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">loginViewController</span> <span class="o">=</span> <span class="kt">Yoyo</span><span class="o">.</span><span class="n">loginViewController</span>
        <span class="n">loginViewController</span><span class="o">.</span><span class="n">loginDelegate</span> <span class="o">=</span> <span class="k">self</span>
        <span class="nf">presentViewController</span><span class="p">(</span><span class="n">loginViewController</span><span class="p">,</span> <span class="nv">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// MARK: LoginViewControllerDelegate</span>
    <span class="kd">func</span> <span class="nf">loginViewController</span><span class="p">(</span><span class="nv">loginViewController</span><span class="p">:</span> <span class="kt">LoginViewController</span><span class="p">,</span> <span class="n">didFinishWithResult</span> <span class="nv">result</span><span class="p">:</span> <span class="kt">LoginResult</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">dismissViewControllerAnimated</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

        <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="kt">Success</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Logged in successfully"</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="kt">Failed</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Something went wrong"</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">.</span><span class="kt">Cancelled</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"User cancelled Login"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this. The &ldquo;id&rdquo; field is your passcode &ldquo;id&rdquo;:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dc05a248-8172-11e5-aa5b-0abe262b2ce9"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"441234567890"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$account_id"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tommy.tester@example.com"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"expires_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-02 15:33:22.227997813 +0000 UTC"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre>

<p><code class="prettyprint">POST https://api.test.yoyowallet/v1/consumer-passcodes</code></p>

<p>This request will either create a new consumer account on the Yoyo Wallet platform, or allow an existing consumer to authenticate.</p>

<h4 id="request-data">Request Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>string</td>
<td>Consumer&rsquo;s email address (optional)</td>
</tr>
<tr>
<td>phone</td>
<td>string</td>
<td>Consumer&rsquo;s mobile phone number</td>
</tr>
</tbody></table>

<p>If the request contains a valid email address and phone number an SMS message will be sent the the user to help authenticate them.</p>

<p>The response returned contains a &ldquo;id&rdquo; field.  This is the identifier of your &ldquo;passcode&rdquo; which will be used in your 2 factor authentication request.</p>

<h4 id="response-data">Response Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>passcode id</td>
</tr>
<tr>
<td>phone</td>
<td>string</td>
<td>Consumer&rsquo;s mobile phone number</td>
</tr>
<tr>
<td>account_id</td>
<td>string</td>
<td>This is your Yoyo Wallet account Id</td>
</tr>
<tr>
<td>email</td>
<td>string</td>
<td>Consumer&rsquo;s email address</td>
</tr>
<tr>
<td>expires_at</td>
<td>string</td>
<td>This is the time the passcode will expire. Normally passcodes are valid for 30 minutes.</td>
</tr>
</tbody></table>

<h3 id="2-create-consumer-session-verify-passcode">2. Create consumer session (verify passcode)</h3>

<p>Once you have received an SMS message with your passcode you can perform the second API call to create a consumer session.</p>

<blockquote>
<p>You POST a request to the API verifying the passcode and generating a session token.</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"device_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e73e3d3b-a95d-4d3c-b9ee-de5492540582+a0b11fa0-57f9-43fc-a541-f868994cf7bb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"device_timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1446368400</span><span class="p">,</span><span class="w">
  </span><span class="nt">"passcode_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"18442"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"passcode_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dc05a248-8172-11e5-aa5b-0abe262b2ce9"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight shell"><code>curl <span class="s1">'https://api.test.yoyowallet.net/v1/consumer-sessions'</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span> <span class="se">\</span>
  -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
  --data-binary <span class="nv">$'</span><span class="o">{</span><span class="s2">"device_id"</span>: <span class="s2">"e73e3d3b-a95d-4d3c-b9ee-de5492540582+a0b11fa0-57f9-43fc-a541-f868994cf7bb"</span>, <span class="se">\</span>
  <span class="s2">"device_timestamp"</span>: 1446368400, <span class="se">\</span>
  <span class="s2">"passcode_code"</span>: <span class="s2">"18442"</span>, <span class="se">\</span>
  <span class="s2">"passcode_id"</span>: <span class="s2">"dc05a248-8172-11e5-aa5b-0abe262b2ce9"</span><span class="o">}</span><span class="s1">'
</span></code></pre>
<pre class="highlight swift"><code>    <span class="n">iOS</span> <span class="kt">SDK</span> <span class="kt">Code</span> <span class="kt">TBD</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this. The &ldquo;id&rdquo; field is your passcode &ldquo;id&rdquo;:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">
  </span><span class="s2">"data"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nt">"consumer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9ae50d73-3bb4-4b55-b258-f93f4f027fb9"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"otp_seed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N2U3MmQ4Y2Q3YmE4NGQ4MDg2OTAzYzNhZGMzYmIxMGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="</span><span class="p">,</span><span class="w">
   </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"296be3889bdf40d9bb9570ff4bf2660f"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"barcode_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"144648288416"</span><span class="w">
  </span><span class="p">}</span><span class="err">,</span><span class="w">
  </span><span class="s2">"metadata"</span><span class="err">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
 </span><span class="err">}</span><span class="w">
</span></code></pre>

<p><code class="prettyprint">POST https://api.test.yoyowallet/v1/consumer-sessions</code></p>

<h4 id="request-data">Request Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>device_id</td>
<td>string</td>
<td>unique identfier for your mobile device</td>
</tr>
<tr>
<td>device_timestamp</td>
<td>int64</td>
<td>current time on your device as a unix timestamp</td>
</tr>
<tr>
<td>passcode_code</td>
<td>string</td>
<td>the value from the SMS message sent to your device</td>
</tr>
<tr>
<td>passcode_id</td>
<td>string</td>
<td>the id of the passcode response in the previous request</td>
</tr>
</tbody></table>

<h4 id="response-data">Response Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>consumer_id</td>
<td>string</td>
<td>unique identfier for the consumer</td>
</tr>
<tr>
<td>otp_seed</td>
<td>string</td>
<td>seed value needed to calculate the one-time-password</td>
</tr>
<tr>
<td>token</td>
<td>string</td>
<td>the session token to represent the consumer</td>
</tr>
<tr>
<td>barcode_token</td>
<td>string</td>
<td>embedded in a barcode to identify a session.</td>
</tr>
</tbody></table>

<h3 id="3-using-the-consumer-39-s-session-token">3. Using the consumer&rsquo;s session token</h3>

<p>Once you have a valid sesion token you will need to include it in all subsequent requests to interact as that consumer.
Sessions tokens are passed to the API in an HTTP header called &lsquo;HTTP_YOYO_TOKEN&rsquo;</p>

<p>If you make a request without a valid access token your request will be rejected.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No session found with token xxx"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="wallet">Wallet</h2>

<h3 id="adding-a-card">Adding a card</h3>

<blockquote>
<p>You POST a request to the API containing the consumers card details.</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"bin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789012345678"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cvv"</span><span class="p">:</span><span class="w"> </span><span class="mi">999</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N1 7ER"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight shell"><code>curl <span class="s1">'https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/cards/'</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span> <span class="se">\</span>
  -H <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
  --data-binary <span class="nv">$'</span><span class="o">{</span> <span class="s2">"bin"</span>: <span class="s2">"123456"</span>, <span class="s2">"number"</span>: <span class="s2">"123456789012345678"</span>, <span class="s2">"exp_month"</span>: 12, <span class="s2">"exp_year"</span>: 2018, <span class="s2">"cvv"</span>: 999, <span class="s2">"postcode"</span>: <span class="s2">"N1 7ER"</span> <span class="o">}</span><span class="s1">'
</span></code></pre>
<pre class="highlight swift"><code>    <span class="n">iOS</span> <span class="kt">SDK</span> <span class="kt">Code</span> <span class="kt">TBD</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<aside class="warning">
Note - in our playground environment we are connected to the Stripe sandbox, so make sure you use <a href='https://stripe.com/docs/testing'>Stripe&rsquo;s test card numbers</a>
</aside>

<blockquote>
<p>The above command returns JSON structured like this. The &ldquo;id&rdquo; field is your card &ldquo;id&rdquo;:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14ab0c2f-b998-4845-815c-ee6328a73ab3"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_default"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5678"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N1 7ER"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><code class="prettyprint">POST https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/cards/</code></p>

<h4 id="request-data">Request Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bin</td>
<td>string</td>
<td>Bank identification number (first 6 digits of card number)</td>
</tr>
<tr>
<td>number</td>
<td>string</td>
<td>credit card number</td>
</tr>
<tr>
<td>exp_month</td>
<td>integer</td>
<td>expiry month MM</td>
</tr>
<tr>
<td>exp_year</td>
<td>integer</td>
<td>expiry year CCYY</td>
</tr>
<tr>
<td>cvv</td>
<td>integer</td>
<td>3 digit card verification value</td>
</tr>
<tr>
<td>postcode</td>
<td>string</td>
<td>post code that card is registered at</td>
</tr>
</tbody></table>

<p>If the card is successfully added to the consumers wallet you will receive a response like below.</p>

<h4 id="response-data">Response Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>unique identifier for card</td>
</tr>
<tr>
<td>active</td>
<td>boolean</td>
<td>card is active</td>
</tr>
<tr>
<td>brand</td>
<td>string</td>
<td>type of card eg. Visa, Mastercard, Amex etc.</td>
</tr>
<tr>
<td>exp_month</td>
<td>integer</td>
<td>expiry month MM</td>
</tr>
<tr>
<td>exp_year</td>
<td>integer</td>
<td>expiry year CCYY</td>
</tr>
<tr>
<td>is_default</td>
<td>boolean</td>
<td>card is default one to use in wallet</td>
</tr>
<tr>
<td>last4</td>
<td>string</td>
<td>last 4 digits of card number</td>
</tr>
<tr>
<td>postcode</td>
<td>string</td>
<td>post code that card is registered at</td>
</tr>
</tbody></table>

<h3 id="removing-a-card">Removing a card</h3>

<p>To delete a card from your wallet, simply send a DELETE request identifying your card, using the consumer&rsquo;s session token.</p>

<blockquote>
<p>You DELETE a request to the API to remove a card</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s1">'https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/cards/'</span> <span class="se">\</span>
  -X <span class="s2">"DELETE"</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span>  <span class="se">\</span>
  -H <span class="s1">'HTTP_YOYO_TOKEN: {TOKEN}'</span>
</code></pre>
<pre class="highlight swift"><code>    <span class="n">iOS</span> <span class="kt">SDK</span> <span class="kt">Code</span> <span class="kt">TBD</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<p><code class="prettyprint">DELETE https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/cards/{CARD_ID}</code></p>

<h3 id="viewing-cards">Viewing cards</h3>

<blockquote>
<p>You GET a request to the API to retrieve your wallet details.</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s1">'https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/cards'</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span> <span class="se">\</span>
  -H <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'HTTP_YOYO_TOKEN: {TOKEN}'</span>
</code></pre>
<pre class="highlight swift"><code>    <span class="n">iOS</span> <span class="kt">SDK</span> <span class="kt">Code</span> <span class="kt">TBD</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this. The &ldquo;id&rdquo; field is your passcode &ldquo;id&rdquo;:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14ab0c2f-b998-4845-815c-ee6328a73ab3"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_default"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5678"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N1 7ER"</span><span class="w">
  </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"85960a0f-0ac2-480d-9188-7d5389b5a82c"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nt">"brand"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Amex"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_month"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"exp_year"</span><span class="p">:</span><span class="w"> </span><span class="mi">2017</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_default"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last4"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"N1 7ER"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><code class="prettyprint">GET https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/cards</code></p>

<h4 id="request-data">Request Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>consumer_id</td>
<td>string</td>
<td>unique identifer of the consumer</td>
</tr>
</tbody></table>

<h4 id="response-data">Response Data</h4>

<p>Same response format as adding a card.</p>

<h2 id="otp">OTP</h2>
<pre class="highlight shell"><code>OTP generation is not available via an API call
</code></pre>
<pre class="highlight swift"><code>
<span class="k">@IBOutlet</span> <span class="k">var</span> <span class="nv">barcodeView</span><span class="p">:</span> <span class="kt">BarcodeView</span><span class="o">!</span> <span class="p">{</span>
    <span class="k">didSet</span> <span class="p">{</span>
        <span class="n">barcodeView</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="kt">Yoyo</span><span class="o">.</span><span class="n">session</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<p>An OTP is a One Time Password is a automatically generated code which refreshes every 30 seconds.</p>

<p><img src="images/otp.png" alt="One time password" style="width: 200px;"/></p>

<p>Your mobile application will need to generate an OTP to display to the retailer for scanning.  To generate an OTP you need to use the functionality in the SDK code.</p>

<h2 id="transactions">Transactions</h2>

<p>When a consumer makes purchases via the Yoyo Wallet platform, they will be recorded as transactions against the consumer&rsquo;s account.</p>

<blockquote>
<p>You GET a request to the API to retrieve your wallet details.</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s1">'https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/transactions'</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span> <span class="se">\</span>
  -H <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'HTTP_YOYO_TOKEN: {TOKEN}'</span>
</code></pre>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">CoreData</span>
<span class="kd">import</span> <span class="kt">Yoyo</span>

<span class="kd">class</span> <span class="kt">TransactionsViewController</span><span class="p">:</span> <span class="kt">UITableViewController</span> <span class="p">{</span>

    <span class="c1">//MARK: Properties</span>
    <span class="k">var</span> <span class="nv">fetchedResultsController</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">try</span><span class="p">?</span> <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="nf">performFetch</span><span class="p">()</span>
            <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
            <span class="n">tableView</span><span class="o">.</span><span class="nf">reloadData</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">dateFormatter</span><span class="p">:</span> <span class="kt">NSDateFormatter</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">dateFormatter</span> <span class="o">=</span> <span class="kt">NSDateFormatter</span><span class="p">()</span>
        <span class="n">dateFormatter</span><span class="o">.</span><span class="n">timeStyle</span> <span class="o">=</span> <span class="kt">NSDateFormatterStyle</span><span class="o">.</span><span class="kt">MediumStyle</span>
        <span class="n">dateFormatter</span><span class="o">.</span><span class="n">dateStyle</span> <span class="o">=</span> <span class="kt">NSDateFormatterStyle</span><span class="o">.</span><span class="kt">LongStyle</span>
        <span class="k">return</span> <span class="n">dateFormatter</span>
    <span class="p">}()</span>

    <span class="c1">// MARK: UIViewController Lifecycle</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="n">guard</span>
            <span class="k">let</span> <span class="nv">session</span> <span class="o">=</span> <span class="kt">Yoyo</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
            <span class="k">let</span> <span class="nv">dataController</span> <span class="o">=</span> <span class="kt">Yoyo</span><span class="o">.</span><span class="n">dataController</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="n">fetchedResultsController</span> <span class="o">=</span> <span class="n">dataController</span><span class="o">.</span><span class="nf">transactionsFetchedResultsController</span><span class="p">(</span><span class="nv">session</span><span class="p">:</span> <span class="n">session</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// MARK: UITableViewDataSource</span>
<span class="kd">extension</span> <span class="kt">TransactionsViewController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">numberOfRowsInSection</span> <span class="nv">section</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>

        <span class="n">guard</span>
            <span class="k">let</span> <span class="nv">sectionInfo</span> <span class="o">=</span> <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="n">sections</span><span class="p">?[</span><span class="n">section</span><span class="p">]</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">sectionInfo</span><span class="o">.</span><span class="n">numberOfObjects</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAtIndexPath</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>

        <span class="k">let</span> <span class="nv">object</span> <span class="o">=</span> <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="nf">objectAtIndexPath</span><span class="p">(</span><span class="n">indexPath</span><span class="p">)</span>

        <span class="n">guard</span>
            <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">(</span><span class="s">"cell"</span><span class="p">),</span>
            <span class="k">let</span> <span class="nv">transaction</span> <span class="o">=</span> <span class="n">object</span> <span class="k">as?</span> <span class="kt">Transaction</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="n">cell</span><span class="o">.</span><span class="n">textLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">dateFormatter</span><span class="o">.</span><span class="nf">stringFromOptionalDate</span><span class="p">(</span><span class="n">transaction</span><span class="o">.</span><span class="n">creationDate</span><span class="p">)</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">detailTextLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">transaction</span><span class="o">.</span><span class="n">identifier</span>

        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// MARK: NSFetchedResultsControllerDelegate</span>
<span class="kd">extension</span> <span class="kt">TransactionsViewController</span><span class="p">:</span> <span class="kt">NSFetchedResultsControllerDelegate</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">controllerWillChangeContent</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">beginUpdates</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">controller</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">,</span> <span class="n">didChangeObject</span> <span class="nv">anObject</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">,</span> <span class="n">atIndexPath</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">?,</span> <span class="n">forChangeType</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">NSFetchedResultsChangeType</span><span class="p">,</span> <span class="nv">newIndexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">?)</span> <span class="p">{</span>

        <span class="k">switch</span> <span class="n">type</span> <span class="p">{</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Insert</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">newIndexPath</span> <span class="o">=</span> <span class="n">newIndexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">insertRowsAtIndexPaths</span><span class="p">([</span><span class="n">newIndexPath</span><span class="p">],</span> <span class="nv">withRowAnimation</span><span class="p">:</span> <span class="o">.</span><span class="kt">Fade</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Update</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">indexPath</span> <span class="o">=</span> <span class="n">indexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">reloadRowsAtIndexPaths</span><span class="p">([</span><span class="n">indexPath</span><span class="p">],</span> <span class="nv">withRowAnimation</span><span class="p">:</span> <span class="o">.</span><span class="kt">Fade</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Move</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">indexPath</span> <span class="o">=</span> <span class="n">indexPath</span><span class="p">,</span> <span class="n">newIndexPath</span> <span class="o">=</span> <span class="n">newIndexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">moveRowAtIndexPath</span><span class="p">(</span><span class="n">indexPath</span><span class="p">,</span> <span class="nv">toIndexPath</span><span class="p">:</span> <span class="n">newIndexPath</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Delete</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">indexPath</span> <span class="o">=</span> <span class="n">indexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">deleteRowsAtIndexPaths</span><span class="p">([</span><span class="n">indexPath</span><span class="p">],</span> <span class="nv">withRowAnimation</span><span class="p">:</span> <span class="o">.</span><span class="kt">Fade</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">controllerDidChangeContent</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">endUpdates</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">11000</span><span class="p">,</span><span class="w">
            </span><span class="nt">"barcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4040144423413972679959220"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"basket"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"product_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b00zy"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"product_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LagerPint"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"product_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"w4lk3rz"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"product_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Crisp Packet"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"consumer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e03f426a-0d45-429f-b0d3-8af64d9b6946"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"consumer_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-07T16:11:55.192617Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GBP"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f9637467-b205-4efb-87b0-ef3c68df473f"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"COMPLETED"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"transaction_key_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d3a4c60c-ceb1-4138-936b-0771b9d86f94"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
            </span><span class="nt">"barcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4040144423289333971137546"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"basket"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"product_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"n1ck4rn"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"product_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JD Coke"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"consumer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e03f426a-0d45-429f-b0d3-8af64d9b6946"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"consumer_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-07T15:53:56.269294Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GBP"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7ec7762a-fc2e-4462-9914-c1d83bd2fe68"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"refunds"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DENIED"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"transaction_key_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d3a4c60c-ceb1-4138-936b-0771b9d86f94"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"has_next"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"has_previous"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><code class="prettyprint">GET https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/transactions</code></p>

<h4 id="request-data">Request Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>consumer_id</td>
<td>path</td>
<td>unique identifer of the consumer</td>
</tr>
<tr>
<td>pagination</td>
<td>query</td>
<td><a href="#pagination">see details</a></td>
</tr>
</tbody></table>

<h4 id="response-data">Response Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>unique identifier of transaction</td>
</tr>
<tr>
<td>account_id</td>
<td>string</td>
<td>unique identifier of platform account</td>
</tr>
<tr>
<td>account_name</td>
<td>string</td>
<td>platform account name</td>
</tr>
<tr>
<td>amount</td>
<td>integer</td>
<td>transaction amount £1.25 = 125</td>
</tr>
<tr>
<td>barcode</td>
<td>string</td>
<td>barcode used for transaction</td>
</tr>
<tr>
<td>consumer_id</td>
<td>string</td>
<td>unique identfier for the consumer</td>
</tr>
<tr>
<td>consumer_name</td>
<td>string</td>
<td>consumer name</td>
</tr>
<tr>
<td>created_at</td>
<td>timestamp</td>
<td>transaction creation time</td>
</tr>
<tr>
<td>currency</td>
<td>string</td>
<td>currency code</td>
</tr>
<tr>
<td>discount</td>
<td>integer</td>
<td>discount amount £1.25 = 125</td>
</tr>
<tr>
<td>reference</td>
<td>string</td>
<td>reference</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>transaction status (COMPLETED/DENIED)</td>
</tr>
<tr>
<td>transaction_key_id</td>
<td>string</td>
<td>unique identifier of transaction key</td>
</tr>
</tbody></table>

<h4 id="basket-data">Basket Data</h4>

<p>Basket data is the list of items the consumer purchased during the transaction.  Basket data is an array of Basket items.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>integer</td>
<td>basket item amount £1.25 = 125</td>
</tr>
<tr>
<td>discount</td>
<td>integer</td>
<td>basket item discount amount £1.25 = 125</td>
</tr>
<tr>
<td>product_code</td>
<td>string</td>
<td>unique identifier for product</td>
</tr>
<tr>
<td>product_name</td>
<td>string</td>
<td>product name</td>
</tr>
</tbody></table>

<h4 id="refund-data">Refund Data</h4>

<p>Refund data is when a previous completed transaction is refunded, partially or fully. Refund data is an array of Refund items.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>unique identifier of refund</td>
</tr>
<tr>
<td>amount</td>
<td>integer</td>
<td>basket item amount £1.25 = 125</td>
</tr>
<tr>
<td>barcode</td>
<td>string</td>
<td>barcode used for transaction</td>
</tr>
<tr>
<td>created_at</td>
<td>timestamp</td>
<td>transaction creation time</td>
</tr>
<tr>
<td>currency</td>
<td>string</td>
<td>currency code</td>
</tr>
<tr>
<td>status</td>
<td>string</td>
<td>transaction status (COMPLETED/DENIED)</td>
</tr>
</tbody></table>

<h2 id="vouchers">Vouchers</h2>

<p>When a consumer earns vouchers on Yoyo Wallet platform, they will be appear in the consumer&rsquo;s account.</p>

<blockquote>
<p>You GET a request to the API to retrieve your wallet details.</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s1">'https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/vouchers'</span> <span class="se">\</span>
  -u <span class="o">{</span>ACCESS_KEY<span class="o">}</span>:<span class="o">{</span>SECRET_KEY<span class="o">}</span> <span class="se">\</span>
  -H <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
  -H <span class="s1">'HTTP_YOYO_TOKEN: {TOKEN}'</span>
</code></pre>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">CoreData</span>
<span class="kd">import</span> <span class="kt">Yoyo</span>

<span class="kd">class</span> <span class="kt">VouchersViewController</span><span class="p">:</span> <span class="kt">UITableViewController</span> <span class="p">{</span>

    <span class="c1">//MARK: Properties</span>
    <span class="k">var</span> <span class="nv">fetchedResultsController</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">try</span><span class="p">?</span> <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="nf">performFetch</span><span class="p">()</span>
            <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="k">self</span>
            <span class="n">tableView</span><span class="o">.</span><span class="nf">reloadData</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">let</span> <span class="nv">dateFormatter</span><span class="p">:</span> <span class="kt">NSDateFormatter</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">dateFormatter</span> <span class="o">=</span> <span class="kt">NSDateFormatter</span><span class="p">()</span>
        <span class="n">dateFormatter</span><span class="o">.</span><span class="n">timeStyle</span> <span class="o">=</span> <span class="kt">NSDateFormatterStyle</span><span class="o">.</span><span class="kt">MediumStyle</span>
        <span class="n">dateFormatter</span><span class="o">.</span><span class="n">dateStyle</span> <span class="o">=</span> <span class="kt">NSDateFormatterStyle</span><span class="o">.</span><span class="kt">LongStyle</span>
        <span class="k">return</span> <span class="n">dateFormatter</span>
    <span class="p">}()</span>

    <span class="c1">//MARK: UIViewController Lifecycle</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>

        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="n">guard</span>
            <span class="k">let</span> <span class="nv">session</span> <span class="o">=</span> <span class="kt">Yoyo</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
            <span class="k">let</span> <span class="nv">dataController</span> <span class="o">=</span> <span class="kt">Yoyo</span><span class="o">.</span><span class="n">dataController</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span>
        <span class="p">}</span>

        <span class="n">fetchedResultsController</span> <span class="o">=</span> <span class="n">dataController</span><span class="o">.</span><span class="nf">vouchersFetchedResultsController</span><span class="p">(</span><span class="nv">session</span><span class="p">:</span> <span class="n">session</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// MARK: UITableViewDataSource</span>
<span class="kd">extension</span> <span class="kt">VouchersViewController</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">numberOfRowsInSection</span> <span class="nv">section</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>

        <span class="n">guard</span>
            <span class="k">let</span> <span class="nv">sectionInfo</span> <span class="o">=</span> <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="n">sections</span><span class="p">?[</span><span class="n">section</span><span class="p">]</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="mi">0</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">sectionInfo</span><span class="o">.</span><span class="n">numberOfObjects</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="nv">tableView</span><span class="p">:</span> <span class="kt">UITableView</span><span class="p">,</span> <span class="n">cellForRowAtIndexPath</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>

        <span class="k">let</span> <span class="nv">object</span> <span class="o">=</span> <span class="n">fetchedResultsController</span><span class="p">?</span><span class="o">.</span><span class="nf">objectAtIndexPath</span><span class="p">(</span><span class="n">indexPath</span><span class="p">)</span>

        <span class="n">guard</span>
            <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCellWithIdentifier</span><span class="p">(</span><span class="s">"cell"</span><span class="p">),</span>
            <span class="k">let</span> <span class="nv">voucher</span> <span class="o">=</span> <span class="n">object</span> <span class="k">as?</span> <span class="kt">Voucher</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="n">cell</span><span class="o">.</span><span class="n">textLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">dateFormatter</span><span class="o">.</span><span class="nf">stringFromOptionalDate</span><span class="p">(</span><span class="n">voucher</span><span class="o">.</span><span class="n">creationDate</span><span class="p">)</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">detailTextLabel</span><span class="p">?</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">voucher</span><span class="o">.</span><span class="n">identifier</span>

        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// MARK: NSFetchedResultsControllerDelegate</span>
<span class="kd">extension</span> <span class="kt">VouchersViewController</span><span class="p">:</span> <span class="kt">NSFetchedResultsControllerDelegate</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">controllerWillChangeContent</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">beginUpdates</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">controller</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">,</span> <span class="n">didChangeObject</span> <span class="nv">anObject</span><span class="p">:</span> <span class="kt">AnyObject</span><span class="p">,</span> <span class="n">atIndexPath</span> <span class="nv">indexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">?,</span> <span class="n">forChangeType</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">NSFetchedResultsChangeType</span><span class="p">,</span> <span class="nv">newIndexPath</span><span class="p">:</span> <span class="kt">NSIndexPath</span><span class="p">?)</span> <span class="p">{</span>

        <span class="k">switch</span> <span class="n">type</span> <span class="p">{</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Insert</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">newIndexPath</span> <span class="o">=</span> <span class="n">newIndexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">insertRowsAtIndexPaths</span><span class="p">([</span><span class="n">newIndexPath</span><span class="p">],</span> <span class="nv">withRowAnimation</span><span class="p">:</span> <span class="o">.</span><span class="kt">Fade</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Update</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">indexPath</span> <span class="o">=</span> <span class="n">indexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">reloadRowsAtIndexPaths</span><span class="p">([</span><span class="n">indexPath</span><span class="p">],</span> <span class="nv">withRowAnimation</span><span class="p">:</span> <span class="o">.</span><span class="kt">Fade</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Move</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">indexPath</span> <span class="o">=</span> <span class="n">indexPath</span><span class="p">,</span> <span class="n">newIndexPath</span> <span class="o">=</span> <span class="n">newIndexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">moveRowAtIndexPath</span><span class="p">(</span><span class="n">indexPath</span><span class="p">,</span> <span class="nv">toIndexPath</span><span class="p">:</span> <span class="n">newIndexPath</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="k">case</span> <span class="o">.</span><span class="kt">Delete</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">indexPath</span> <span class="o">=</span> <span class="n">indexPath</span> <span class="p">{</span>
                <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">deleteRowsAtIndexPaths</span><span class="p">([</span><span class="n">indexPath</span><span class="p">],</span> <span class="nv">withRowAnimation</span><span class="p">:</span> <span class="o">.</span><span class="kt">Fade</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">controllerDidChangeContent</span><span class="p">(</span><span class="nv">controller</span><span class="p">:</span> <span class="kt">NSFetchedResultsController</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">tableView</span><span class="p">?</span><span class="o">.</span><span class="nf">endUpdates</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<pre class="highlight java"><code>    <span class="n">Android</span> <span class="n">SDK</span> <span class="n">Code</span> <span class="n">TBD</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"897328d2-b1fe-4e99-a8e3-0204b4ac106f"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d5h6fvd4-452f-47fc-c525-747g6h5ab67g"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1443172134260310"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"consumer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8a66f9c4-782e-45cc-ab23-047f6f4abf83"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-07T16:11:55.192617Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount_coverage"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
            </span><span class="nt">"start_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-07-01T00:00:00.0Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"end_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-12-31T00:00:00.0Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a00994fc-e105-46d9-8435-5aff536398d1"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"£1 off JD Coke"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"redeemed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"redemption_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-07T16:11:55.192617Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"897328d2-b1fe-4e99-a8e3-0204b4ac106f"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"campaign_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cfhdsvf7-j4ud-86gh-cd56-f8d7g7e58hr6dg"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1443172133909833"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"consumer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8a66f9c4-782e-45cc-ab23-047f6f4abf83"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-07T16:11:55.192617Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount_coverage"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"percentage"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount_value"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
            </span><span class="nt">"start_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-01T00:00:00.0Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"end_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-31T00:00:00.0Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ef3364a2-413e-4556-8c77-c724549f29bb"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20% Off Everything!"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"redeemed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"redemption_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-07T16:11:55.192617Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><code class="prettyprint">GET https://api.test.yoyowallet.net/v1/consumers/{CONSUMER_ID}/vouchers</code></p>

<h4 id="request-data">Request Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>consumer_id</td>
<td>path</td>
<td>unique identifer of the consumer</td>
</tr>
</tbody></table>

<h4 id="voucher-data">Voucher Data</h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>string</td>
<td>unique identifier of transaction</td>
</tr>
<tr>
<td>account_id</td>
<td>string</td>
<td>unique identifier of platform account</td>
</tr>
<tr>
<td>campaign_id</td>
<td>string</td>
<td>unique identifier of campaign</td>
</tr>
<tr>
<td>code</td>
<td>string</td>
<td>voucher code</td>
</tr>
<tr>
<td>created_at</td>
<td>timestamp</td>
<td>transaction creation time</td>
</tr>
<tr>
<td>discount_coverage</td>
<td>string</td>
<td>discount coverage</td>
</tr>
<tr>
<td>discount_value</td>
<td>integer</td>
<td>discount value £1.25 = 125</td>
</tr>
<tr>
<td>start_at</td>
<td>timestamp</td>
<td>voucher start time</td>
</tr>
<tr>
<td>end_at</td>
<td>timestamp</td>
<td>voucher end time</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>voucher name</td>
</tr>
<tr>
<td>product_group_id</td>
<td>string</td>
<td>unique identfier for the product group</td>
</tr>
<tr>
<td>redeemed_at</td>
<td>timestamp</td>
<td>voucher redemption time</td>
</tr>
<tr>
<td>redemption_reference</td>
<td>string</td>
<td>redemption reference</td>
</tr>
<tr>
<td>updated_at</td>
<td>timestamp</td>
<td>voucher updated time</td>
</tr>
</tbody></table>

          <h1 id="dashboard-api">Dashboard API</h1>

<p>The Dashboard API is a RESTful API which uses JSON formatted data for its requests and responses. It used by administrative dashboards to communicate with the Yoyo Wallet platform.</p>

<p>Documentation not currently available.</p>

          <h1 id="transaction-api">Transaction API</h1>

<p>The Transaction API is used to perform interactions at point of sale with the Yoyo platform. It is typically used by retailers EPOS devices.</p>

<p>Documentation is not publicly available</p>

          <h1 id="errors">Errors</h1>

<p>The Yoyo Wallet API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request - A required parameter is missing, or the submitted data is invalid</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized - No valid API key provided (ie you can’t be authenticated)</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden - Request is not authorised (eg you don’t have permission to perform this action).</td>
</tr>
<tr>
<td>404</td>
<td>Not Found - Could not find the resource requested</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; Request with an invalid method</td>
</tr>
<tr>
<td>415</td>
<td>Unsupported media type - Request has invalid content-type header</td>
</tr>
<tr>
<td>429</td>
<td>Too many requests - Rate limiting</td>
</tr>
<tr>
<td>500</td>
<td>Server error - Unanticipated server error</td>
</tr>
<tr>
<td>503</td>
<td>Service unavailable - If the service is down for maintenance</td>
</tr>
</tbody></table>

          <h1 id="pagination">Pagination</h1>

<p>Many of the Yoyo Wallet API endpoints support the concept of pagination.</p>

<p>This is where the result set would be too large to return in a single request, so the API caller can control which subset of the results is returned.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>limit</td>
<td>integer</td>
<td>is the maximum number of results returned in a single request</td>
</tr>
<tr>
<td>starting_after</td>
<td>timestamp</td>
<td>selects entities with a creation timestamp starting after this time</td>
</tr>
<tr>
<td>ending_before</td>
<td>timestamp</td>
<td>selects entities with a creation timestamp ending before this time</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="swift">swift</a>
                <a href="#" data-language-name="java">java</a>
          </div>
      </div>
    </div>
  </body>
</html>
